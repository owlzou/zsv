(this.webpackJsonpzshaderviewer=this.webpackJsonpzshaderviewer||[]).push([[0],{113:function(e,t,n){},114:function(e,t,n){},443:function(e,t,n){"use strict";n.r(t);var r=n(10),a=n(0),c=n.n(a),o=n(19),i=n.n(o),l=(n(113),n(18)),s=n(59),u=(n(114),n(12)),j=n(27),b=[{vex:"attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nvarying lowp vec2 vTexCoord;\nvoid main(){\n    vTexCoord = aTexCoord;\n    gl_Position=vec4(aPosition,1.0);\n}",frag:"varying lowp vec2 vTexCoord;\nuniform sampler2D uSampler;\nvoid main(){\n    gl_FragColor = texture2D(uSampler,vTexCoord);\n}",name:"\u56fe\u7247 - \u57fa\u7840"}];function d(e,t,n){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("ShaderInfoLog: ".concat(e.getShaderInfoLog(r)));return r}function h(e,t,n,r,a,c,o){var i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW);var s=e.getAttribLocation(t,n);if(e.vertexAttribPointer(s,a,e.FLOAT,!1,c,o),null!=i){var u=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),e.STATIC_DRAW)}return e.enableVertexAttribArray(s),l}function x(e,t,n,r){e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT);var a=function(e,t,n){var r=d(e,t,e.VERTEX_SHADER),a=d(e,n,e.FRAGMENT_SHADER),c=e.createProgram();if(e.attachShader(c,r),e.attachShader(c,a),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new Error("ProgramInfoLog: ".concat(e.getProgramInfoLog(c)));return c}(e,t,n);h(e,a,"aPosition",[-1,-1,0,-1,1,0,1,-1,0,1,1,0],3,0,0),h(e,a,"aTexCoord",[0,1,0,0,1,1,1,0],2,0,0),e.useProgram(a),function(e,t,n){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),e.uniform1i(e.getUniformLocation(t,"uSampler"),0)}(e,a,r),e.drawArrays(e.TRIANGLE_STRIP,0,4)}var f=n.p+"static/media/jessica-pamp-sGRMspZmfPE-unsplash.5cffdaca.jpg";function O(e,t){var n=Object(a.useRef)(null),c=Object(a.useState)(null),o=Object(l.a)(c,2),i=o[0],s=o[1],u=Object(a.useCallback)((function(e){console.log("Load Image");var t=new Image;t.src=e||f,t.onload=function(){console.log("Image loaded"),n.current.width=t.width,n.current.height=t.height;var e=n.current.getContext("webgl2");e.viewport(0,0,e.canvas.width,e.canvas.height),s(t)}}),[n]),j=function(e){switch(e){case"0":break;case"1":u(f);break;case"2":break;default:u(e)}};return Object(a.useImperativeHandle)(t,(function(){return{load:j}})),Object(a.useEffect)((function(){try{var t=n.current.getContext("webgl2");i&&x(t,e.vertexSource,e.fragmentSource,i),e.onError(null)}catch(r){e.onError(r)}}),[e.vertexSource,e.fragmentSource,i,e]),Object(a.useEffect)((function(){u(e.src)}),[u,e.src]),Object(r.jsx)("canvas",{ref:n,style:{height:"50vh",width:"100%",objectFit:"contain"}})}var v=Object(a.forwardRef)(O);var g=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],i=function(e){o(!1)};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(u.Button,{icon:Object(r.jsx)(j.Folder,{}),auto:!0,type:"abort",onClick:function(){return o(!0)},children:"\u52a0\u8f7d\u9884\u8bbe"}),Object(r.jsxs)(u.Modal,{open:c,onClose:i,children:[Object(r.jsx)(u.Modal.Title,{children:"\u9009\u62e9\u9884\u8bbe"}),Object(r.jsx)(u.Modal.Content,{children:b.map((function(t,n){return Object(r.jsx)(u.Button,{onClick:function(){e.onPreset(t),i()},children:t.name},n)}))}),Object(r.jsx)(u.Modal.Action,{passive:!0,onClick:function(e){return(0,e.close)()},children:"\u5173\u95ed"})]})]})},m=n(107);n(440),n(441),n(442);function p(e){return Object(r.jsxs)(u.Col,{style:{height:"calc( 50vh - (var(--nav-height) / 2) - 10px)",display:"flex",flexDirection:"column"},children:[Object(r.jsx)(u.Text,{h5:!0,children:e.title}),Object(r.jsx)(m.Controlled,{value:e.value,onBeforeChange:function(t,n,r){e.onChange(r)},options:{tabSize:4,mode:"x-shader/x-vertex",theme:"dracula",matchBrackets:!0,lineNumbers:!0},style:{height:"100%"}})]})}var T=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],i=[{attribute:Object(r.jsx)(u.Code,{children:"attribute"}),type:"vec3",name:"aPosition",description:"\u8f93\u5165\u5750\u6807"},{attribute:Object(r.jsx)(u.Code,{children:"attribute"}),type:"vec2",name:"aTexCoord",description:"\u9876\u70b9\u7684\u7eb9\u7406\u5750\u6807"},{attribute:Object(r.jsx)(u.Code,{children:"uniform"}),type:"sampler2D",name:"uSampler",description:"\u7eb9\u7406\u6570\u636e"}];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(u.Button,{icon:Object(r.jsx)(j.Lambda,{}),auto:!0,type:"abort",onClick:function(){return o(!0)},children:"\u53d8\u91cf\u652f\u6301"}),Object(r.jsxs)(u.Modal,{open:c,onClose:function(e){o(!1)},width:"35rem",children:[Object(r.jsx)(u.Modal.Content,{children:Object(r.jsxs)(u.Table,{data:i,children:[Object(r.jsx)(u.Table.Column,{prop:"attribute",label:"\u5c5e\u6027"}),Object(r.jsx)(u.Table.Column,{prop:"type",label:"\u7c7b\u578b"}),Object(r.jsx)(u.Table.Column,{prop:"name",label:"\u540d\u79f0"}),Object(r.jsx)(u.Table.Column,{prop:"description",label:"\u63cf\u8ff0"})]})}),Object(r.jsx)(u.Modal.Action,{passive:!0,onClick:function(e){return(0,e.close)()},children:"\u5173\u95ed"})]})]})};function E(e){return Object(r.jsx)("form",{className:"control",children:Object(r.jsxs)(u.Row,{children:[Object(r.jsx)("label",{children:"\u80cc\u666f"}),Object(r.jsxs)(u.Select,{placeholder:"\u9009\u62e9\u80cc\u666f",onChange:function(t){var n=Object(s.a)(Object(s.a)({},e.value),{},{background:t});e.onLoadImage(t),e.onChange(n)},value:e.value.background,children:[Object(r.jsx)(u.Select.Option,{value:"1",children:"\u56fe\u7247\u4e00"}),Object(r.jsx)(u.Select.Option,{value:"2",children:"\u81ea\u5b9a\u4e49\u56fe\u7247"})]}),"2"===e.value.background&&Object(r.jsx)(u.Button,{size:"small",icon:Object(r.jsx)(j.Upload,{}),type:"secondary",onClick:function(){var t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=function(){if(t.files[0]){var n=new FileReader;n.onload=function(t){e.onLoadImage(t.target.result)},n.readAsDataURL(t.files[0])}},t.click()},auto:!0,children:"\u4e0a\u4f20\u56fe\u7247"})]})})}var C=function(){var e=Object(a.useState)(b[0].vex),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(b[0].frag),i=Object(l.a)(o,2),s=i[0],d=i[1],h=Object(a.useState)(null),x=Object(l.a)(h,2),f=x[0],O=x[1],m=Object(a.useState)({background:"1"}),C=Object(l.a)(m,2),R=C[0],S=C[1],A=Object(a.useRef)();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"nav",children:[Object(r.jsxs)("div",{className:"nav-left",children:[Object(r.jsx)(u.Text,{h4:!0,style:{margin:"0",display:"inline-block",marginRight:"10px"},children:"Z ShaderViewer"}),Object(r.jsx)(u.Badge,{size:"small",children:"Beta"})]}),Object(r.jsxs)("div",{className:"nav-right",children:[Object(r.jsx)(T,{}),Object(r.jsx)(g,{onPreset:function(e){console.log("Load preset ".concat(e.name)),c(e.vex),d(e.frag)}}),Object(r.jsx)(u.Button,{icon:Object(r.jsx)(j.Github,{}),auto:!0,type:"abort",children:"Github"})]})]}),Object(r.jsxs)(u.Row,{gap:.8,style:{marginBottom:"15px"},children:[Object(r.jsxs)(u.Col,{children:[Object(r.jsx)("div",{style:{textAlign:"center"},children:Object(r.jsx)(v,{ref:A,src:null,vertexSource:n,fragmentSource:s,onError:function(e){return O(e)}})}),Object(r.jsx)(u.Divider,{}),Object(r.jsx)(E,{value:R,onChange:function(e){S(e)},onLoadImage:function(e){A.current.load(e)}}),f&&Object(r.jsx)(u.Note,{type:"error",label:"error",className:"control",style:{marginTop:"10px"},children:f})]}),Object(r.jsxs)(u.Col,{style:{height:"100%"},children:[Object(r.jsx)(p,{title:"\u9876\u70b9\u7740\u8272\u5668",value:n,onChange:function(e){c(e)}}),Object(r.jsx)(p,{title:"\u7247\u6bb5\u7740\u8272\u5668",value:s,onChange:function(e){return d(e)}})]})]})]})};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsxs)(u.GeistProvider,{children:[Object(r.jsx)(u.CssBaseline,{}),Object(r.jsx)(C,{})]})}),document.getElementById("root"))}},[[443,1,2]]]);
//# sourceMappingURL=main.432f7c7e.chunk.js.map