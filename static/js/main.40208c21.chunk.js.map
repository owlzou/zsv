{"version":3,"sources":["Components/Cmirror.tsx","assets/favicon-32x32.png","utils/data.js","utils/webgl.js","assets/jessica-pamp-sGRMspZmfPE-unsplash.jpg","assets/anh-nguyen-_Uqj5BQb-mw-unsplash.jpg","Components/ZCanvas.tsx","Components/Tools.tsx","Components/Settings.tsx","Components/PresetModal.tsx","Components/VaribleModal.tsx","Components/CreditModal.tsx","App.tsx","index.tsx"],"names":["Cmirror","props","options","tabSize","mode","theme","matchBrackets","lineNumbers","value","onBeforeChange","editor","data","onChange","preset","vex","frag","name","note","attribute","type","description","codeMirrorThemeNames","createShader","gl","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","Error","getShaderInfoLog","getProgram","vsource","fsource","vertShader","VERTEX_SHADER","fragShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","simpleBindBuffer","size","offset","stride","indices","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","index","getAttribLocation","vertexAttribPointer","FLOAT","indexesBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","enableVertexAttribArray","bindTexture","image","texture","createTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_NEAREST","generateMipmap","uniform1i","getUniformLocation","draw","vertexSource","fragmentSource","uTime","vertices","tex","clearColor","clear","COLOR_BUFFER_BIT","useProgram","uniform2f","parseFloat","width","height","uniform1f","drawArrays","TRIANGLE_STRIP","ZCanvas","canvasRef","useRef","useState","setImage","background","form","setForm","autoRun","setAutoRun","undefined","error","setError","animRef","loadImage","useCallback","src","console","log","img","Image","textureImage","onload","current","getContext","viewport","canvas","anim","time","e","message","window","requestAnimationFrame","useEffect","preserveDrawingBuffer","cancelAnimationFrame","textureImage2","Container","direction","style","textAlign","ref","objectFit","className","placeholder","val","obj","Option","scale","icon","onClick","input","document","createElement","accept","onchange","files","reader","FileReader","event","target","result","readAsDataURL","click","auto","url","toDataURL","a","download","href","body","appendChild","remove","checked","minHeight","readOnly","RGB2Vec","rgbInput","setRgbInput","rgbOutput","setRgbOutput","out","rgb","m","exec","toLowerCase","r","parseInt","groups","R","toFixed","g","G","b","B","rgb2vec","_e","Tools","defaultSettings","cmTheme","Settings","SetCodeMirrorTheme","prop","map","PresetModal","closeHandler","onClose","visible","Title","Content","gap","item","xs","onPreset","Action","passive","VaribleModal","Column","label","CreditModal","pkg","version","Date","getFullYear","App","setVertexSource","setFragmentSource","presetModalVisible","setPresetModalVisible","creditModalVisible","setCreditModalVisible","varibleModalVisible","setVaribleModalVisible","settings","setSettings","storage","localStorage","JSON","parse","softDarkTheme","Themes","createFromDark","palette","fetch","text","Header","alignContent","sm","md","marginRight","alt","Anchor","h4","margin","justify","news","stringify","switchThemes","open","themes","themeType","padding","rel","initialValue","Item","code","ReactDOM","render","StrictMode","getElementById"],"mappings":"2qCAWe,SAASA,EAAQC,GAC9B,IAAMC,EAAU,CACdC,QAAS,EACTC,KAAM,oBACNC,MAAOJ,EAAMI,MACbC,eAAe,EACfC,aAAa,GAGf,OACI,cAAC,aAAD,CACEC,MAAOP,EAAMO,MACbC,eAAgB,SAACC,EAAQC,EAAMH,GAC7BP,EAAMW,SAASJ,IAEjBN,QAASA,IC1BF,ICAFW,EAAS,CACpB,CACEC,IAAK,eACLC,KAAM,eACNC,KAAM,6BAER,CACEF,IAAK,eACLC,KAAM,YACNC,KAAM,6BAER,CACEF,IAAK,eACLC,KAAM,YACNC,KAAM,oDAER,CACEF,IAAK,eACLC,KAAM,cACNC,KAAM,6BAIGC,EAAO,CAClB,CACEC,UAAW,YACXC,KAAM,OACNH,KAAM,YACNI,YAAa,4BAEf,CACEF,UAAW,YACXC,KAAM,OACNH,KAAM,YACNI,YAAa,8CAEf,CACEF,UAAW,UACXC,KAAM,YACNH,KAAM,WACNI,YAAa,4BAEf,CACEF,UAAW,UACXC,KAAM,OACNH,KAAM,cACNI,YAAa,kCAEf,CACEF,UAAW,UACXC,KAAM,QACNH,KAAM,QACNI,YAAa,4DAIJC,EAAuB,CAClC,WACA,aACA,SACA,SACA,kBACA,WACA,WACA,aACA,cACA,eACA,SACA,aACA,SACA,aACA,UACA,UACA,eACA,gBACA,UACA,UACA,cACA,eACA,YACA,WACA,OACA,UACA,SACA,cACA,YACA,UACA,kBACA,iBACA,qBACA,WACA,MACA,WACA,WACA,UACA,QACA,OACA,MACA,QACA,OACA,eACA,eACA,eACA,gBACA,iBACA,aACA,WACA,OACA,YACA,YACA,OACA,aACA,wBACA,0BACA,OACA,WACA,cACA,UACA,WACA,OACA,QACA,WCjHF,SAASC,EAAaC,EAAIC,EAAQL,GAChC,IAAIM,EAASF,EAAGD,aAAaH,GAG7B,GAFAI,EAAGG,aAAaD,EAAQD,GACxBD,EAAGI,cAAcF,IACZF,EAAGK,mBAAmBH,EAAQF,EAAGM,gBACpC,MAAM,IAAIC,MAAJ,0BAA6BP,EAAGQ,iBAAiBN,KAEzD,OAAOA,EAYF,SAASO,EAAWT,EAAIU,EAASC,GACtC,IAAIC,EAAab,EAAaC,EAAIU,EAASV,EAAGa,eAC1CC,EAAaf,EAAaC,EAAIW,EAASX,EAAGe,iBAC1CC,EAAgBhB,EAAGiB,gBAIvB,GAHAjB,EAAGkB,aAAaF,EAAeJ,GAC/BZ,EAAGkB,aAAaF,EAAeF,GAC/Bd,EAAGmB,YAAYH,IACVhB,EAAGoB,oBAAoBJ,EAAehB,EAAGqB,aAC5C,MAAM,IAAId,MAAJ,2BAA8BP,EAAGsB,kBAAkBN,KAE3D,OAAOA,EAgBF,SAASO,EACdvB,EACAgB,EACAvB,EACAL,EACAoC,EACAC,EACAC,GAEC,IADDC,EACA,uDADU,KAEJC,EAAS5B,EAAG6B,eAClB7B,EAAG8B,WAAW9B,EAAG+B,aAAcH,GAC/B5B,EAAGgC,WAAWhC,EAAG+B,aAAc,IAAIE,aAAa7C,GAAOY,EAAGkC,aAC1D,IAAMC,EAAQnC,EAAGoC,kBAAkBpB,EAAevB,GAGlD,GAFAO,EAAGqC,oBAAoBF,EAAOX,EAAMxB,EAAGsC,OAAO,EAAOb,EAAQC,GAE9C,MAAXC,EAAiB,CACnB,IAAMY,EAAgBvC,EAAG6B,eACzB7B,EAAG8B,WAAW9B,EAAGwC,qBAAsBD,GACvCvC,EAAGgC,WACDhC,EAAGwC,qBACH,IAAIC,YAAYd,GAChB3B,EAAGkC,aAKP,OADAlC,EAAG0C,wBAAwBP,GACpBP,EAWF,SAASe,EAAY3C,EAAIgB,EAAe4B,GAC7C,IAAIC,EAAU7C,EAAG8C,gBAEjB9C,EAAG2C,YAAY3C,EAAG+C,WAAYF,GAE9B7C,EAAGgD,WAAWhD,EAAG+C,WAAY,EAAG/C,EAAGiD,KAAMjD,EAAGiD,KAAMjD,EAAGkD,cAAeN,GAEpE5C,EAAGmD,cAAcnD,EAAG+C,WAAY/C,EAAGoD,mBAAoBpD,EAAGqD,QAC1DrD,EAAGmD,cACDnD,EAAG+C,WACH/C,EAAGsD,mBACHtD,EAAGuD,uBAGLvD,EAAGwD,eAAexD,EAAG+C,YAGrB/C,EAAGyD,UAAUzD,EAAG0D,mBAAmB1C,EAAe,YAAa,GAG1D,SAAS2C,EAAK3D,EAAI4D,EAAcC,EAAgBjB,GAAmB,IAAZkB,EAAW,uDAAH,EAE9DC,EAAW,EAAE,GAAI,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,GAEjDC,EAAM,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAClChE,EAAGiE,WAAW,EAAG,EAAG,EAAG,GACvBjE,EAAGkE,MAAMlE,EAAGmE,kBAEZ,IAAMnD,EAAgBP,EAAWT,EAAI4D,EAAcC,GAEnDtC,EAAiBvB,EAAIgB,EAAe,YAAa+C,EAAU,EAAG,EAAG,GACjExC,EAAiBvB,EAAIgB,EAAe,YAAagD,EAAK,EAAG,EAAG,GAC5DhE,EAAGoE,WAAWpD,GAGdhB,EAAGqE,UACDrE,EAAG0D,mBAAmB1C,EAAe,eACrCsD,WAAW1B,EAAM2B,OACjBD,WAAW1B,EAAM4B,SAGnBxE,EAAGyE,UAAUzE,EAAG0D,mBAAmB1C,EAAe,SAAU8C,EAAQ,KACpEnB,EAAY3C,EAAIgB,EAAe4B,GAC/B5C,EAAG0E,WAAW1E,EAAG2E,eAAgB,EAAG,GCtIvB,UAA0B,8DCA1B,MAA0B,4DCiN1BC,MAtLf,SAAiBlG,GACf,IAAMmG,EAAYC,iBAA0B,MADZ,EAENC,mBAAkC,MAF5B,mBAEzBnC,EAFyB,KAElBoC,EAFkB,OAGRD,mBAAgB,CAAEE,WAAY,UAHtB,mBAGzBC,EAHyB,KAGnBC,EAHmB,OAIFJ,oBAAS,GAJP,mBAIzBK,EAJyB,KAIhBC,EAJgB,OAKNN,wBAAgBO,GALV,mBAKzBC,EALyB,KAKlBC,EALkB,KAM1BxF,EAAK8E,iBAAsC,MAC3CW,EAAUX,iBAAsB,MAEhCY,EAAYC,uBAChB,SAACC,GACC,GAAkB,iBAAPA,EAAX,CAGAC,QAAQC,IAAI,cACZ,IAAIC,EAAM,IAAIC,MACdD,EAAIH,IAAMA,GAAOK,EACjBF,EAAIG,OAAS,WACXL,QAAQC,IAAI,gBACZjB,EAAWsB,QAAS5B,MAAQwB,EAAKxB,MACjCM,EAAWsB,QAAS3B,OAASuB,EAAKvB,OAClC,IAAMxE,EAAK6E,EAAWsB,QAASC,WAAW,UAC1CpG,EAAGqG,SAAS,EAAG,EAAGrG,EAAGsG,OAAO/B,MAAOvE,EAAGsG,OAAO9B,QAC7CQ,EAASe,OAGb,CAAClB,IAuCG0B,EAAOZ,uBACX,WAAuB,IAAtBa,EAAqB,uDAAN,EACd,IACE7C,EAAK3D,EAAGmG,QAASzH,EAAMkF,aAAclF,EAAMmF,eAAgBjB,EAAO4D,GAClEhB,EAAS,IACT,MAAOiB,GACPjB,EAASiB,EAAEC,SACXjB,EAAQU,QAAU,KAEhBV,EAAQU,UACVV,EAAQU,QAAUQ,OAAOC,sBAAsBL,MAGnD,CAAC7H,EAAMkF,aAAclF,EAAMmF,eAAgBjB,IA2C7C,OAvCAiE,qBAAU,WACR7G,EAAGmG,QAAUtB,EAAWsB,QAASC,WAAW,SAAU,CACpDU,uBAAuB,MAExB,IAEHD,qBAAU,WACJzB,EACqB,MAAnBK,EAAQU,SACVN,QAAQC,IAAI,mBACZL,EAAQU,QAAUQ,OAAOC,sBAAsBL,KAE/CV,QAAQC,IAAR,4BAAiCL,EAAQU,QAAzC,kBACAQ,OAAOI,qBAAqBtB,EAAQU,SACpCV,EAAQU,QAAUQ,OAAOC,sBAAsBL,IAEvCnB,IACVmB,IACwB,OAApBd,EAAQU,UACVN,QAAQC,IAAI,qBAAuBL,EAAQU,SAC3CQ,OAAOI,qBAAqBtB,EAAQU,SACpCV,EAAQU,QAAU,SAGrB,CAACI,EAAMnB,IAEVyB,qBAAU,WACR,OAAQ3B,EAAKD,YACX,IAAK,QACHS,EAAUO,GACV,MACF,IAAK,SACHP,EAAUsB,MAKb,CAAC9B,EAAKD,WAAYS,IAGnB,eAAC,IAAKuB,UAAN,CAAgBC,UAAU,SAA1B,UACE,qBAAKC,MAAO,CAAEC,UAAW,UAAzB,SACE,wBACEC,IAAKxC,EACLsC,MAAO,CAAE3C,OAAQ,OAAQD,MAAO,OAAQ+C,UAAW,eAGvD,cAAC,IAAD,IACA,iCACE,sBAAKC,UAAU,MAAf,UACE,cAAC,IAAD,2BACA,eAAC,IAAD,CACEC,YAAY,2BACZnI,SA1GO,SAACoI,GAChB,GAAkB,iBAAPA,EAAiB,CAC1B,IAAIC,EAAG,2BAAQxC,GAAR,IAAcD,WAAYwC,IACjCtC,EAAQuC,KAwGFzI,MAAOiG,EAAKD,WAHd,UAKE,cAAC,IAAO0C,OAAR,CAAe1I,MAAM,QAArB,gCACA,cAAC,IAAO0I,OAAR,CAAe1I,MAAM,SAArB,gCACA,cAAC,IAAO0I,OAAR,CAAe1I,MAAM,cAArB,+CAEmB,gBAApBiG,EAAKD,YACJ,qCACE,cAAC,IAAD,CACE2C,MAAO,GACPC,KAAM,cAAC,SAAD,IACNjI,KAAK,YACLkI,QAhHM,WAClB,IAAMC,EAAQC,SAASC,cAAc,SACrCF,EAAMnI,KAAO,OACbmI,EAAMG,OAAS,UACfH,EAAMI,SAAW,WACf,GAAIJ,EAAMK,MAAO,GAAI,CACnB,IAAIC,EAAS,IAAIC,WACjBD,EAAOnC,OAAS,SAACqC,GACf7C,EAAU6C,EAAMC,OAAQC,SAE1BJ,EAAOK,cAAcX,EAAMK,MAAO,MAGtCL,EAAMY,SAoGMC,MAAI,EALN,sCASA,cAAC,IAAD,CACEhB,MAAO,GACPC,KAAM,cAAC,WAAD,IACNC,QAxGQ,WACpB,IAAMe,EAAMhE,EAAWsB,QAAS2C,UAAU,aACpCC,EAAIf,SAASC,cAAc,KACjCc,EAAEC,SAAW,WACbD,EAAEE,KAAOJ,EACTb,SAASkB,KAAKC,YAAYJ,GAC1BA,EAAEJ,QACFI,EAAEK,UAkGUR,MAAI,EAJN,4CAWN,sBAAKrB,UAAU,MAAf,UACE,cAAC,IAAD,uCACA,cAAC,IAAD,CACE8B,QAASjE,EACT/F,SAAU,SAACoH,GAAD,OAAOpB,EAAWoB,EAAE+B,OAAOa,eAGzC,cAAC,IAAD,CACEpK,MAAOsG,GAAgB,GACvBhB,MAAM,OACN4C,MAAO,CAAEmC,UAAW,SACpBC,UAAQ,W,QC1LlB,SAASC,IAAW,IAAD,EACezE,mBAAS,IADxB,mBACV0E,EADU,KACAC,EADA,OAEiB3E,mBAAS,IAF1B,mBAEV4E,EAFU,KAECC,EAFD,KAYjB,OARA/C,qBAAU,WACR,IAAIgD,EAAM,GACV,IACEA,EApBN,SAAiBC,GACf,IACMC,EADG,YAAG,6CAAH,eACKC,KAAKF,EAAIG,eACvB,GAAIF,EAAG,CACL,IAAMG,GAAKC,SAASJ,EAAEK,OAAQC,EAAG,IAAM,KAAKC,QAAQ,GAC9CC,GAAKJ,SAASJ,EAAEK,OAAQI,EAAG,IAAM,KAAKF,QAAQ,GAC9CG,GAAKN,SAASJ,EAAEK,OAAQM,EAAG,IAAM,KAAKJ,QAAQ,GACpD,MAAM,IAAN,OAAWJ,EAAX,YAAgBK,EAAhB,YAAqBE,EAArB,KAEA,MAAM,IAAIlK,MAAM,iBAWRoK,CAAQlB,GACd,MAAOmB,IACThB,EAAaC,KACZ,CAACJ,IAGF,sBAAKlC,UAAU,MAAf,UACE,cAAC,IAAD,8BACA,cAAC,IAAD,CACEtI,MAAOwK,EACPjC,YAAY,UACZnI,SAAU,SAACoH,GAAD,OAAYiD,EAAYjD,EAAE+B,OAAOvJ,UAE7C,cAAC,IAAD,CAAOsK,UAAQ,EAACtK,MAAO0K,EAAWnC,YAAY,wBAarCqD,MARf,WACE,OACE,cAAC,IAAD,UACE,cAACrB,EAAD,OC/BOsB,EAAkB,CAAEC,QAAS,WAAYjM,MAAO,SA+B9CkM,EA7BE,SAACtM,GAChB,IAAMuM,EAAqB,WACzB,OACE,sBAAK1D,UAAU,MAAf,UACE,cAAC,IAAD,mDACA,cAAC,IAAD,CACEC,YAAY,2BACZvI,MAAOP,EAAMwM,KAAKH,QAClB1L,SAAU,SAACoI,GAAD,OACR/I,EAAMW,SAAN,2BAAoBX,EAAMwM,MAA1B,IAAgCH,QAAStD,MAJ7C,SAOG3H,EAAqBqL,KAAI,SAAC1D,GAAD,OACxB,cAAC,IAAOE,OAAR,CAAe1I,MAAOwI,EAAtB,SACGA,GAD6BA,YAS1C,OACE,cAAC,IAAD,UACE,cAACwD,EAAD,OCUSG,MAlCf,SAAqB1M,GACnB,IAAM2M,EAAe,WACnB3M,EAAM4M,WAER,OACI,eAAC,IAAD,CAAOC,QAAS7M,EAAM6M,QAASD,QAASD,EAAc9G,MAAM,QAA5D,UACE,cAAC,IAAMiH,MAAP,uCACA,cAAC,IAAMC,QAAP,UACE,cAAC,IAAKxE,UAAN,CAAgByE,IAAK,EAArB,SACGpM,EAAO6L,KAAI,SAACQ,EAAMxJ,GACjB,OACE,cAAC,IAAD,CAAkByJ,GAAI,GAAtB,SACE,cAAC,IAAD,CACE9D,QAAS,WACPpJ,EAAMmN,SAASF,GACfN,KAGFlE,MAAO,CAAC5C,MAAM,QANhB,SAQGoH,EAAKlM,MAHD0C,IANEA,UAgBnB,cAAC,IAAM2J,OAAP,CAAcC,SAAO,EAACjE,QAASuD,EAA/B,8BCVOW,MAvBf,SAAsBtN,GACpB,IAAM2M,EAAe,WACnB3M,EAAM4M,WAEFlM,EAAOM,EAAKyL,KAAI,SAAC1D,GAAD,mBAAC,eAAcA,GAAf,IAAoBhI,KAAM,cAAC,IAAD,UAAOgI,EAAIhI,YAE3D,OACE,eAAC,IAAD,CAAO8L,QAAS7M,EAAM6M,QAASD,QAASD,EAAc9G,MAAM,QAA5D,UACE,cAAC,IAAMkH,QAAP,UACE,eAAC,IAAD,CAAOrM,KAAMA,EAAb,UACE,cAAC,IAAM6M,OAAP,CAAcf,KAAK,YAAYgB,MAAM,iBACrC,cAAC,IAAMD,OAAP,CAAcf,KAAK,OAAOgB,MAAM,iBAChC,cAAC,IAAMD,OAAP,CAAcf,KAAK,OAAOgB,MAAM,iBAChC,cAAC,IAAMD,OAAP,CAAcf,KAAK,cAAcgB,MAAM,sBAG3C,cAAC,IAAMJ,OAAP,CAAcC,SAAO,EAACjE,QAASuD,EAA/B,8B,QCwCSc,MAzDf,SAAqBzN,GACnB,OACE,eAAC,IAAD,CAAO6M,QAAS7M,EAAM6M,QAASD,QAAS5M,EAAM4M,QAAS/G,MAAM,QAA7D,UACE,eAAC,IAAMkH,QAAP,WACE,8BACE,iDACA,eAAC,IAAD,CAAO7D,MAAO,GAAd,eAAsBwE,EAAIC,cAE5B,yCAAW,IAAIC,MAAOC,cAAtB,gBAEA,mDACA,+BACE,6BACE,mBAAGtD,KAAK,+CAAR,gCAIF,6BACE,mBAAGA,KAAK,8CAAR,iCAIF,6BACE,mBAAGA,KAAK,qCAAR,2BAGJ,oHACA,+BACE,0CACW,IACT,mBAAGA,KAAK,oGAAR,0BAEK,IAJP,KAKK,IACH,mBAAGA,KAAK,oGAAR,yBAIF,0CACW,IACT,mBAAGA,KAAK,iGAAR,wBAEK,IAJP,KAKK,IACH,mBAAGA,KAAK,iGAAR,+BAMN,cAAC,IAAM6C,OAAP,CAAcC,SAAO,EAACjE,QAASpJ,EAAM4M,QAArC,8BCqJSkB,MArLf,WAAgB,IAAD,EAC2BzH,mBAAS,IADpC,mBACNnB,EADM,KACQ6I,EADR,OAE+B1H,mBAAS,IAFxC,mBAENlB,EAFM,KAEU6I,EAFV,OAIuC3H,oBAAS,GAJhD,mBAIN4H,EAJM,KAIcC,EAJd,OAKuC7H,oBAAS,GALhD,mBAKN8H,EALM,KAKcC,EALd,OAMyC/H,oBAAS,GANlD,mBAMNgI,EANM,KAMeC,EANf,OASmBjI,mBAAS+F,GAT5B,mBASNmC,EATM,KASIC,EATJ,KAYbrG,qBAAU,WACR,IAAMsG,EAAUxG,OAAOyG,aACvB,IACEF,EAAYG,KAAKC,MAAMH,EAAO,WAC9B,MAAOvC,IACTiB,EAASvM,EAAO,MACf,IAEH,IAUMiO,EAAgBC,IAAOC,eAAe,CAC1C7N,KAAM,WACN8N,QAAS,KAKL7B,EAAQ,uCAAG,WAAOvM,GAAP,iBAAAyJ,EAAA,6DACflD,QAAQC,IAAR,sBAA2BxG,EAAOG,OADnB,SAEUkO,MAAM,aAAD,OAAcrO,EAAOC,MAFpC,8BAE4CqO,OAF5C,cAETrO,EAFS,gBAGWoO,MAAM,aAAD,OAAcrO,EAAOE,OAHrC,+BAG8CoO,OAH9C,QAGTpO,EAHS,OAIfiN,EAAgBlN,GAChBmN,EAAkBlN,GALH,4CAAH,sDAQRqO,EAAS,kBACb,eAAC,IAAK5G,UAAN,CAAgByE,IAAK,EAAGoC,aAAa,SAArC,UACE,eAAC,IAAD,CAAMC,GAAI,GAAIC,GAAI,GAAlB,UACE,qBAAKpI,IX1EE,q8FW0ESuB,MAAO,CAAE8G,YAAa,QAAUC,IAAI,SACpD,eAAC,IAAMC,OAAP,WACE,cAAC,IAAD,CAAMC,IAAE,EAACjH,MAAO,CAAEkH,OAAQ,KAA1B,4BAGA,cAAC,IAAD,CAAOzG,MAAO,GAAd,wBAGJ,eAAC,IAAKX,UAAN,CAAgBqH,QAAQ,WAAWR,aAAa,SAASC,GAAI,GAAIC,GAAI,GAArE,UACE,cAAC,IAAD,UACE,cAAC,IAAD,CACEnG,KAAyB,UAAnBoF,EAASnO,MAAoB,cAAC,MAAD,IAAU,cAAC,OAAD,IAC7C8J,MAAI,EACJhJ,KAAK,QACLkI,QAAS,kBA1CE,WACnB,IAAMyG,EAAI,2BACLtB,GADK,IAERnO,MAA0B,aAAnBmO,EAASnO,MAAuB,QAAU,aAEnDoO,EAAYqB,GACI5H,OAAOyG,aAChB,SAAeC,KAAKmB,UAAUD,GAmCdE,IAJjB,SAMsB,UAAnBxB,EAASnO,MAAoB,eAAO,mBAGzC,cAAC,IAAD,UACE,cAAC,IAAD,CACE+I,KAAM,cAAC,SAAD,IACNe,MAAI,EACJhJ,KAAK,QACLkI,QAAS,kBAAMkF,GAAuB,IAJxC,wCASF,cAAC,IAAD,UACE,cAAC,IAAD,CACEnF,KAAM,cAAC,SAAD,IACNe,MAAI,EACJhJ,KAAK,QACLkI,QAAS,kBAAM8E,GAAsB,IAJvC,wCASF,cAAC,IAAD,UACE,cAAC,IAAD,CACE/E,KAAM,cAAC,OAAD,IACNe,MAAI,EACJhJ,KAAK,QACLkI,QAAS,kBAAMgF,GAAsB,IAJvC,4BASF,cAAC,IAAD,UACE,cAAC,IAAD,CACEjF,KAAM,cAAC,SAAD,IACNe,MAAI,EACJhJ,KAAK,QACLkI,QAAS,WACPnB,OAAO+H,KAAK,gCAAiC,WALjD,6BAeR,OACE,eAAC,IAAD,CAAeC,OAAQ,CAACpB,GAAgBqB,UAAW3B,EAASnO,MAA5D,UACE,cAAC,IAAD,IACA,sBAAKyI,UAAU,MAAf,UACE,cAACsG,EAAD,IACA,eAAC,IAAK5G,UAAN,CAAgByE,IAAK,EAAGvE,MAAO,CAAE0H,QAAS,UAA1C,UACE,cAAC,IAAD,CAAMd,GAAI,GAAIC,GAAI,GAAlB,SACE,cAAC,EAAD,CACEpK,aAAcA,EACdC,eAAgBA,MAGpB,eAAC,IAAD,CAAMkK,GAAI,GAAIC,GAAI,GAAlB,UACE,sBACEc,IAAI,aACJ7F,KAAI,oDAA+CgE,EAASlC,QAAxD,UAEN,eAAC,IAAD,CAAMgE,aAAa,IAAI5H,MAAO,CAAE5C,MAAO,QAAvC,UACE,cAAC,IAAKyK,KAAN,CAAW9C,MAAM,iCAAQjN,MAAM,IAA/B,SACE,cAACR,EAAD,CACEQ,MAAO2E,EACP9E,MAAOmO,EAASlC,QAChB1L,SAAU,SAAC4P,GACTxC,EAAgBwC,QAItB,cAAC,IAAKD,KAAN,CAAW9C,MAAM,iCAAQjN,MAAM,IAA/B,SACE,cAACR,EAAD,CACEQ,MAAO4E,EACP/E,MAAOmO,EAASlC,QAChB1L,SAAU,SAAC4P,GAAD,OAAkBvC,EAAkBuC,QAGlD,cAAC,IAAKD,KAAN,CAAW9C,MAAM,eAAKjN,MAAM,IAA5B,SACE,cAAC,EAAD,MAEF,cAAC,IAAK+P,KAAN,CAAW9C,MAAM,eAAKjN,MAAM,IAA5B,SACE,cAAC,EAAD,CACEiM,KAAM+B,EACN5N,SAAU,SAACoI,GACOd,OAAOyG,aAChB,SAAeC,KAAKmB,UAAU/G,GACrCyF,EAAYzF,oBAQ1B,cAAC,EAAD,CACEoE,SAAUA,EACVN,QAASoB,EACTrB,QAAS,kBAAMsB,GAAsB,MAEvC,cAAC,EAAD,CACErB,QAASwB,EACTzB,QAAS,kBAAM0B,GAAuB,MAExC,cAAC,EAAD,CACEzB,QAASsB,EACTvB,QAAS,kBAAMwB,GAAsB,UCnM7CoC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,eAAC,IAAD,WACE,cAAC,IAAD,IACA,cAAC,EAAD,SAGJpH,SAASqH,eAAe,W","file":"static/js/main.40208c21.chunk.js","sourcesContent":["import { Controlled as CodeMirror } from \"react-codemirror2\";\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/mode/clike/clike.js\";\n// import \"codemirror/theme/dracula.css\";\n\ninterface ICmirror {\n  value: string;\n  onChange: (a: string) => void;\n  theme: string;\n}\n\nexport default function Cmirror(props: ICmirror) {\n  const options = {\n    tabSize: 4,\n    mode: \"x-shader/x-vertex\",\n    theme: props.theme,\n    matchBrackets: true,\n    lineNumbers: true,\n  };\n\n  return (      \n      <CodeMirror\n        value={props.value}\n        onBeforeChange={(editor, data, value) => {\n          props.onChange(value);\n        }}\n        options={options}\n      ></CodeMirror>\n  );\n}\n","export default \"data:image/png;base64,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\"","export const preset = [\n  {\n    vex: \"basic2D.vert\",\n    frag: \"basic2D.frag\",\n    name: \"图片-基础\",\n  },\n  {\n    vex: \"basic2D.vert\",\n    frag: \"gray.frag\",\n    name: \"图片-灰度\",\n  },\n  {\n    vex: \"basic2D.vert\",\n    frag: \"blur.frag\",\n    name: \"均值模糊（测试）\",\n  },\n  {\n    vex: \"basic2D.vert\",\n    frag: \"glitch.frag\",\n    name: \"故障图像\",\n  },\n];\n\nexport const note = [\n  {\n    attribute: \"attribute\",\n    type: \"vec3\",\n    name: \"aPosition\",\n    description: \"输入坐标\",\n  },\n  {\n    attribute: \"attribute\",\n    type: \"vec2\",\n    name: \"aTexCoord\",\n    description: \"顶点的纹理坐标\",\n  },\n  {\n    attribute: \"uniform\",\n    type: \"sampler2D\",\n    name: \"uSampler\",\n    description: \"纹理数据\",\n  },\n  {\n    attribute: \"uniform\",\n    type: \"vec2\",\n    name: \"uResolution\",\n    description: \"画布的大小\",\n  },\n  {\n    attribute: \"uniform\",\n    type: \"float\",\n    name: \"uTime\",\n    description: \"Shader 运行的时间（秒）\",\n  },\n];\n\nexport const codeMirrorThemeNames = [\n  \"3024-day\",\n  \"3024-night\",\n  \"abbott\",\n  \"abcdef\",\n  \"ambiance-mobile\",\n  \"ambiance\",\n  \"ayu-dark\",\n  \"ayu-mirage\",\n  \"base16-dark\",\n  \"base16-light\",\n  \"bespin\",\n  \"blackboard\",\n  \"cobalt\",\n  \"colorforth\",\n  \"darcula\",\n  \"dracula\",\n  \"duotone-dark\",\n  \"duotone-light\",\n  \"eclipse\",\n  \"elegant\",\n  \"erlang-dark\",\n  \"gruvbox-dark\",\n  \"hopscotch\",\n  \"icecoder\",\n  \"idea\",\n  \"isotope\",\n  \"juejin\",\n  \"lesser-dark\",\n  \"liquibyte\",\n  \"lucario\",\n  \"material-darker\",\n  \"material-ocean\",\n  \"material-palenight\",\n  \"material\",\n  \"mbo\",\n  \"mdn-like\",\n  \"midnight\",\n  \"monokai\",\n  \"moxer\",\n  \"neat\",\n  \"neo\",\n  \"night\",\n  \"nord\",\n  \"oceanic-next\",\n  \"panda-syntax\",\n  \"paraiso-dark\",\n  \"paraiso-light\",\n  \"pastel-on-dark\",\n  \"railscasts\",\n  \"rubyblue\",\n  \"seti\",\n  \"shadowfox\",\n  \"solarized\",\n  \"ssms\",\n  \"the-matrix\",\n  \"tomorrow-night-bright\",\n  \"tomorrow-night-eighties\",\n  \"ttcn\",\n  \"twilight\",\n  \"vibrant-ink\",\n  \"xq-dark\",\n  \"xq-light\",\n  \"yeti\",\n  \"yonce\",\n  \"zenburn\",\n];\n","/**\n * 编译着色器\n *\n * @param {WebGLRenderingContext} gl - gl上下文\n * @param {string} source - 着色器源码\n * @param {*} type - 类型，gl.VERTEX_SHADER 或 gl.FRAGMENT_SHADER\n * @returns\n */\nfunction createShader(gl, source, type) {\n  let shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw new Error(`ShaderInfoLog:\\n${gl.getShaderInfoLog(shader)}`);\n  }\n  return shader;\n}\n\n/**\n * 编译并连接着色器\n *\n * @export\n * @param {WebGLRenderingContext} gl - gl上下文\n * @param {string} vsource - 顶点着色器源码\n * @param {string} fsource - 片段着色器源码\n * @returns {WebGLProgram|null} - 连接好的WebGLProgram，失败则返回null\n */\nexport function getProgram(gl, vsource, fsource) {\n  let vertShader = createShader(gl, vsource, gl.VERTEX_SHADER);\n  let fragShader = createShader(gl, fsource, gl.FRAGMENT_SHADER);\n  let shaderProgram = gl.createProgram();\n  gl.attachShader(shaderProgram, vertShader);\n  gl.attachShader(shaderProgram, fragShader);\n  gl.linkProgram(shaderProgram);\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    throw new Error(`ProgramInfoLog:\\n${gl.getProgramInfoLog(shaderProgram)}`);\n  }\n  return shaderProgram;\n}\n\n/**\n * 简单缓冲绑定\n *\n * @param {*} gl - gl上下文\n * @param {*} shaderProgram - shaderProgram\n * @param {*} name - 着色器里的属性名称\n * @param {*} data - 数据源\n * @param {*} size - 一组数据长度\n * @param {*} offset - 偏移\n * @param {*} stride - 步长\n * @param {*} indices - 索引（如果有）\n * @returns buffer\n */\nexport function simpleBindBuffer(\n  gl,\n  shaderProgram,\n  name,\n  data,\n  size,\n  offset,\n  stride,\n  indices = null\n) {\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n  const index = gl.getAttribLocation(shaderProgram, name);\n  gl.vertexAttribPointer(index, size, gl.FLOAT, false, offset, stride);\n\n  if (indices != null) {\n    const indexesBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexesBuffer);\n    gl.bufferData(\n      gl.ELEMENT_ARRAY_BUFFER,\n      new Uint16Array(indices),\n      gl.STATIC_DRAW\n    );\n  }\n\n  gl.enableVertexAttribArray(index);\n  return buffer;\n}\n\n/**\n *\n *\n * @param {*} gl - gl上下文\n * @param {*} shaderProgram - shaderProgram\n * @param {*} image - 图片元素\n * @returns\n */\nexport function bindTexture(gl, shaderProgram, image) {\n  let texture = gl.createTexture();\n  //绑定纹理\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  //指定二维纹理贴图，详细级别。颜色组件，数据格式，数据类型，数据源\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n  //设置纹理在放大和缩小时候采用的采样方案。\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(\n    gl.TEXTURE_2D,\n    gl.TEXTURE_MIN_FILTER,\n    gl.LINEAR_MIPMAP_NEAREST\n  );\n  //生成mipmap webgl 1.0 只能给图片边长为2的幂的图片生成 mipmap\n  gl.generateMipmap(gl.TEXTURE_2D);\n  //结束设置\n  //gl.activeTexture(gl.TEXTURE0);\n  gl.uniform1i(gl.getUniformLocation(shaderProgram, \"uSampler\"), 0);\n}\n\nexport function draw(gl, vertexSource, fragmentSource, image, uTime = 0) {\n  //正方形\n  const vertices = [-1, -1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0];\n  //纹理对应坐标\n  const tex = [0, 1, 0, 0, 1, 1, 1, 0];\n  gl.clearColor(0, 0, 0, 1);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n  //创建着色器\n  const shaderProgram = getProgram(gl, vertexSource, fragmentSource);\n  //设置缓冲\n  simpleBindBuffer(gl, shaderProgram, \"aPosition\", vertices, 3, 0, 0);\n  simpleBindBuffer(gl, shaderProgram, \"aTexCoord\", tex, 2, 0, 0);\n  gl.useProgram(shaderProgram);\n  //未来添加其他可以绑定的参数也在这里：\n  // - canvas 的大小\n  gl.uniform2f(\n    gl.getUniformLocation(shaderProgram, \"uResolution\"),\n    parseFloat(image.width),\n    parseFloat(image.height)\n  );\n  // - 运行时间\n  gl.uniform1f(gl.getUniformLocation(shaderProgram, \"uTime\"), uTime / 1000);\n  bindTexture(gl, shaderProgram, image);\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n}","export default __webpack_public_path__ + \"static/media/jessica-pamp-sGRMspZmfPE-unsplash.5cffdaca.jpg\";","export default __webpack_public_path__ + \"static/media/anh-nguyen-_Uqj5BQb-mw-unsplash.a6275f3c.jpg\";","import { useCallback, useRef, useEffect, useState } from \"react\";\nimport { draw } from \"../utils/webgl.js\";\nimport textureImage from \"../assets/jessica-pamp-sGRMspZmfPE-unsplash.jpg\";\nimport textureImage2 from \"../assets/anh-nguyen-_Uqj5BQb-mw-unsplash.jpg\";\nimport { Upload, Download } from \"@geist-ui/icons\";\nimport {\n  Button,\n  Toggle,\n  Select,\n  Divider,\n  Text,\n  Textarea,\n  Grid,\n} from \"@geist-ui/core\";\n\ninterface IZCanvas {\n  vertexSource: string;\n  fragmentSource: string;\n}\n\ninterface IForm {\n  background: BaseCanvas;\n}\n\ntype BaseCanvas = \"Image\" | \"Image2\" | \"CustomImage\";\ntype Error = string | undefined;\n\nfunction ZCanvas(props: IZCanvas) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [image, setImage] = useState<HTMLImageElement | null>(null);\n  const [form, setForm] = useState<IForm>({ background: \"Image\" });\n  const [autoRun, setAutoRun] = useState(false); // auto play animation\n  const [error, setError] = useState<Error>(undefined);\n  const gl = useRef<WebGL2RenderingContext | null>(null);\n  const animRef = useRef<number | null>(null);\n\n  const loadImage = useCallback(\n    (src: string | ArrayBuffer | null) => {\n      if (typeof src == \"object\") {\n        return;\n      }\n      console.log(\"Load Image\");\n      let img = new Image();\n      img.src = src || textureImage;\n      img.onload = () => {\n        console.log(\"Image loaded\");\n        canvasRef!.current!.width = img!.width;\n        canvasRef!.current!.height = img!.height;\n        const gl = canvasRef!.current!.getContext(\"webgl2\")!;\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n        setImage(img);\n      };\n    },\n    [canvasRef]\n  );\n\n  const bgHandle = (val: String | string[]) => {\n    if (typeof val == \"string\") {\n      let obj = { ...form, background: val as BaseCanvas };\n      setForm(obj);\n    }\n  };\n\n  const uploadImage = () => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \"image/*\";\n    input.onchange = () => {\n      if (input.files![0]) {\n        var reader = new FileReader();\n        reader.onload = (event) => {\n          loadImage(event.target!.result);\n        };\n        reader.readAsDataURL(input.files![0]);\n      }\n    };\n    input.click();\n  };\n\n  const downloadImage = () => {\n    const url = canvasRef!.current!.toDataURL(\"image/png\");\n    const a = document.createElement(\"a\");\n    a.download = \"download\";\n    a.href = url;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n  };\n\n  // callback 里的值本身会被缓存（闭包）\n  // 如果在 callback 里改变 state 值不会反映在递归的 callback 里（会反映在外面的 useEffect 里，ref 没有这个限制\n  // 所以 autoRun 的值在递归里不会变，取消动画搬到了 useEffect 中\n  const anim = useCallback(\n    (time: number = 0) => {\n      try {\n        draw(gl.current, props.vertexSource, props.fragmentSource, image, time);\n        setError(\"\");\n      } catch (e: any) {\n        setError(e.message);\n        animRef.current = null;\n      }\n      if (animRef.current) {\n        animRef.current = window.requestAnimationFrame(anim);\n      }\n    },\n    [props.vertexSource, props.fragmentSource, image]\n  );\n\n  // init\n  useEffect(() => {\n    gl.current = canvasRef!.current!.getContext(\"webgl2\", {\n      preserveDrawingBuffer: true,\n    });\n  }, []);\n\n  useEffect(() => {\n    if (autoRun) {\n      if (animRef.current == null) {\n        console.log(\"Start Animation\");\n        animRef.current = window.requestAnimationFrame(anim);\n      } else {\n        console.log(`Cancel animation: ${animRef.current}, rebuild ...`);\n        window.cancelAnimationFrame(animRef.current);\n        animRef.current = window.requestAnimationFrame(anim);\n      }\n    } else if (!autoRun) {\n      anim();\n      if (animRef.current !== null) {\n        console.log(\"Cancel animation: \" + animRef.current);\n        window.cancelAnimationFrame(animRef.current);\n        animRef.current = null;\n      }\n    }\n  }, [anim, autoRun]);\n\n  useEffect(() => {\n    switch (form.background) {\n      case \"Image\":\n        loadImage(textureImage);\n        break;\n      case \"Image2\":\n        loadImage(textureImage2);\n        break;\n      default:\n        break;\n    }\n  }, [form.background, loadImage]);\n\n  return (\n    <Grid.Container direction=\"column\">\n      <div style={{ textAlign: \"center\" }}>\n        <canvas\n          ref={canvasRef}\n          style={{ height: \"50vh\", width: \"100%\", objectFit: \"contain\" }}\n        ></canvas>\n      </div>\n      <Divider />\n      <form>\n        <div className=\"row\">\n          <Text>背景</Text>\n          <Select\n            placeholder=\"选择背景\"\n            onChange={bgHandle}\n            value={form.background}\n          >\n            <Select.Option value=\"Image\">图片一</Select.Option>\n            <Select.Option value=\"Image2\">图片二</Select.Option>\n            <Select.Option value=\"CustomImage\">自定义图片</Select.Option>\n          </Select>\n          {form.background === \"CustomImage\" && (\n            <>\n              <Button\n                scale={0.8}\n                icon={<Upload />}\n                type=\"secondary\"\n                onClick={uploadImage}\n                auto\n              >\n                上传图片\n              </Button>\n              <Button\n                scale={0.8}\n                icon={<Download />}\n                onClick={downloadImage}\n                auto\n              >\n                下载图片\n              </Button>\n            </>\n          )}\n        </div>\n        <div className=\"row\">\n          <Text>运行动画</Text>\n          <Toggle\n            checked={autoRun}\n            onChange={(e) => setAutoRun(e.target.checked)}\n          />\n        </div>\n        <Textarea\n          value={error ? error : \"\"}\n          width=\"100%\"\n          style={{ minHeight: \"150px\" }}\n          readOnly\n        ></Textarea>\n      </form>\n    </Grid.Container>\n  );\n}\n\nexport default ZCanvas;\n","import { useEffect, useState } from \"react\";\nimport { Input, Card, Text } from \"@geist-ui/core\";\n\nfunction rgb2vec(rgb: string) {\n  const reg = /#?(?<R>[0-9a-f]{2})(?<G>[0-9a-f]{2})(?<B>[0-9a-f]{2})/g;\n  const m = reg.exec(rgb.toLowerCase());\n  if (m) {\n    const r = (parseInt(m.groups!.R, 16) / 255).toFixed(2);\n    const g = (parseInt(m.groups!.G, 16) / 255).toFixed(2);\n    const b = (parseInt(m.groups!.B, 16) / 255).toFixed(2);\n    return `(${r},${g},${b})`;\n  } else {\n    throw new Error(\"Invaild Input\");\n  }\n}\n\nfunction RGB2Vec() {\n  const [rgbInput, setRgbInput] = useState(\"\");\n  const [rgbOutput, setRgbOutput] = useState(\"\");\n\n  useEffect(() => {\n    let out = \"\";\n    try {\n      out = rgb2vec(rgbInput);\n    } catch (_e) {}\n    setRgbOutput(out);\n  }, [rgbInput]);\n\n  return (\n    <div className=\"row\">\n      <Text>HEX 转 vec3</Text>\n      <Input\n        value={rgbInput}\n        placeholder=\"#79FFE1\"\n        onChange={(e: any) => setRgbInput(e.target.value)}\n      />\n      <Input readOnly value={rgbOutput} placeholder=\"(0.47,1.00,0.88)\" />\n    </div>\n  );\n}\n\nfunction Tools() {\n  return (\n    <Card>\n      <RGB2Vec />\n    </Card>\n  );\n}\n\nexport default Tools;\n","import { Card, Select, Text } from \"@geist-ui/core\";\nimport { codeMirrorThemeNames } from \"../utils/data.js\";\n\ninterface ISettings {\n  cmTheme: string;\n  theme: string;\n}\n\ninterface ISettingsProp {\n  prop: ISettings;\n  onChange: (a: ISettings) => void;\n}\n\nexport const defaultSettings = { cmTheme: \"3024-day\", theme: \"light\" };\n\nconst Settings = (props: ISettingsProp) => {\n  const SetCodeMirrorTheme = () => {\n    return (\n      <div className=\"row\">\n        <Text>选择 CodeMirror 主题</Text>\n        <Select\n          placeholder=\"选择主题\"\n          value={props.prop.cmTheme}\n          onChange={(val) =>\n            props.onChange({ ...props.prop, cmTheme: val as string })\n          }\n        >\n          {codeMirrorThemeNames.map((val) => (\n            <Select.Option value={val} key={val}>\n              {val}\n            </Select.Option>\n          ))}\n        </Select>\n      </div>\n    );\n  };\n\n  return (\n    <Card>\n      <SetCodeMirrorTheme />\n    </Card>\n  );\n};\n\nexport default Settings;\n","import { Button, Modal, Grid } from \"@geist-ui/core\";\nimport { preset } from \"../utils/data.js\";\n\nexport interface Preset {\n  name: string;\n  vex: string;\n  frag: string;\n}\n\ninterface IPresetModal {\n  onPreset: (a: Preset) => void;\n  onClose: () => void;\n  visible:boolean;\n}\n\nfunction PresetModal(props: IPresetModal) {\n  const closeHandler = () => {\n    props.onClose()\n  };\n  return (    \n      <Modal visible={props.visible} onClose={closeHandler} width=\"30rem\">\n        <Modal.Title>选择预设</Modal.Title>\n        <Modal.Content>\n          <Grid.Container gap={2}>\n            {preset.map((item, index) => {\n              return (\n                <Grid key={index} xs={12}>\n                  <Button\n                    onClick={() => {\n                      props.onPreset(item);\n                      closeHandler();\n                    }}\n                    key={index}\n                    style={{width:\"100%\"}}\n                  >\n                    {item.name}\n                  </Button>\n                </Grid>\n              );\n            })}\n          </Grid.Container>\n        </Modal.Content>\n        <Modal.Action passive onClick={closeHandler}>\n          关闭\n        </Modal.Action>\n      </Modal>\n  );\n}\n\nexport default PresetModal;\n","//显示支持的变量\nimport { Modal, Table, Code } from \"@geist-ui/core\";\nimport { note } from \"../utils/data.js\";\n\ninterface IModal {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction VaribleModal(props: IModal) {\n  const closeHandler = () => {\n    props.onClose();\n  };\n  const data = note.map((val) => ({ ...val, name: <Code>{val.name}</Code> }));\n\n  return (\n    <Modal visible={props.visible} onClose={closeHandler} width=\"35rem\">\n      <Modal.Content>\n        <Table data={data}>\n          <Table.Column prop=\"attribute\" label=\"属性\" />\n          <Table.Column prop=\"type\" label=\"类型\" />\n          <Table.Column prop=\"name\" label=\"名称\" />\n          <Table.Column prop=\"description\" label=\"描述\" />\n        </Table>\n      </Modal.Content>\n      <Modal.Action passive onClick={closeHandler}>\n        关闭\n      </Modal.Action>\n    </Modal>\n  );\n}\n\nexport default VaribleModal;\n","import { Modal, Badge } from \"@geist-ui/core\";\nimport pkg from \"../../package.json\";\n\ninterface IModal {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction CreditModal(props: IModal) {\n  return (\n    <Modal visible={props.visible} onClose={props.onClose} width=\"35rem\">\n      <Modal.Content>\n        <p>\n          <b>Z Shader Viewer </b>\n          <Badge scale={0.8}>v.{pkg.version}</Badge>\n        </p>\n        <p>2020 - {new Date().getFullYear()} By owlzou</p>\n\n        <p>鸣谢：</p>\n        <ul>\n          <li>\n            <a href=\"https://github.com/facebook/create-react-app\">\n              create-react-app\n            </a>\n          </li>\n          <li>\n            <a href=\"https://github.com/scniro/react-codemirror2\">\n              react-codemirror2\n            </a>\n          </li>\n          <li>\n            <a href=\"https://github.com/geist-org/react\">geist-ui</a>\n          </li>\n        </ul>\n        <p>APP中使用的默认图片来自于Unsplash：</p>\n        <ul>\n          <li>\n            Photo by{\" \"}\n            <a href=\"https://unsplash.com/@yessijes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">\n              Jessica Pamp\n            </a>{\" \"}\n            on{\" \"}\n            <a href=\"https://unsplash.com/@yessijes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">\n              Unsplash\n            </a>\n          </li>\n          <li>\n            Photo by{\" \"}\n            <a href=\"https://unsplash.com/@pwign?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">\n              Anh Nguyen\n            </a>{\" \"}\n            on{\" \"}\n            <a href=\"https://unsplash.com/@pwign?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">\n              Unsplash\n            </a>\n          </li>\n        </ul>\n      </Modal.Content>\n      <Modal.Action passive onClick={props.onClose}>\n        关闭\n      </Modal.Action>\n    </Modal>\n  );\n}\n\nexport default CreditModal;\n","import \"./App.css\";\nimport { useEffect, useState } from \"react\";\nimport {\n  Button,\n  Text,\n  Badge,\n  Grid,\n  Tabs,\n  CssBaseline,\n  GeistProvider,\n  Themes,\n} from \"@geist-ui/core\";\nimport { Github, Folder, Info, Lambda, Sun, Moon } from \"@geist-ui/icons\";\nimport Cmirror from \"./Components/Cmirror\";\n//\nimport logo from \"./assets/favicon-32x32.png\";\nimport { preset } from \"./utils/data.js\";\n//\nimport ZCanvas from \"./Components/ZCanvas\";\nimport Tools from \"./Components/Tools\";\nimport Settings, { defaultSettings } from \"./Components/Settings\";\n// Modals\nimport PresetModal, { Preset } from \"./Components/PresetModal\";\nimport VaribleModal from \"./Components/VaribleModal\";\nimport CreditModal from \"./Components/CreditModal\";\n\nfunction App() {\n  const [vertexSource, setVertexSource] = useState(\"\");\n  const [fragmentSource, setFragmentSource] = useState(\"\");\n  // Modal\n  const [presetModalVisible, setPresetModalVisible] = useState(false);\n  const [creditModalVisible, setCreditModalVisible] = useState(false);\n  const [varibleModalVisible, setVaribleModalVisible] = useState(false);\n  // Theme\n  // const [themeType, setThemeType] = useState(\"light\");\n  const [settings, setSettings] = useState(defaultSettings);\n\n  // init\n  useEffect(() => {\n    const storage = window.localStorage;\n    try {\n      setSettings(JSON.parse(storage[\"settings\"]));\n    } catch (_e) {}\n    onPreset(preset[0]);\n  }, []);\n\n  const switchThemes = () => {\n    const news = {\n      ...settings,\n      theme: settings.theme === \"softDark\" ? \"light\" : \"softDark\",\n    };\n    setSettings(news);\n    const storage = window.localStorage;\n    storage[\"settings\"] = JSON.stringify(news);\n  };\n\n  const softDarkTheme = Themes.createFromDark({\n    type: \"softDark\",\n    palette: {\n      //todo\n    },\n  });\n\n  const onPreset = async (preset: Preset) => {\n    console.log(`Load preset ${preset.name}`);\n    const vex = await (await fetch(`./shaders/${preset.vex}`)).text();\n    const frag = await (await fetch(`./shaders/${preset.frag}`)).text();\n    setVertexSource(vex);\n    setFragmentSource(frag);\n  };\n\n  const Header = () => (\n    <Grid.Container gap={2} alignContent=\"center\">\n      <Grid sm={24} md={12}>\n        <img src={logo} style={{ marginRight: \"10px\" }} alt=\"logo\"></img>\n        <Badge.Anchor>\n          <Text h4 style={{ margin: \"0\" }}>\n            Z ShaderViewer\n          </Text>\n          <Badge scale={0.8}>Beta</Badge>\n        </Badge.Anchor>\n      </Grid>\n      <Grid.Container justify=\"flex-end\" alignContent=\"center\" sm={24} md={12}>\n        <Grid>\n          <Button\n            icon={settings.theme === \"light\" ? <Sun /> : <Moon />}\n            auto\n            type=\"abort\"\n            onClick={() => switchThemes()}\n          >\n            {settings.theme === \"light\" ? \"白天\" : \"黑夜\"}\n          </Button>\n        </Grid>\n        <Grid>\n          <Button\n            icon={<Lambda />}\n            auto\n            type=\"abort\"\n            onClick={() => setVaribleModalVisible(true)}\n          >\n            变量支持\n          </Button>\n        </Grid>\n        <Grid>\n          <Button\n            icon={<Folder />}\n            auto\n            type=\"abort\"\n            onClick={() => setPresetModalVisible(true)}\n          >\n            加载预设\n          </Button>\n        </Grid>\n        <Grid>\n          <Button\n            icon={<Info />}\n            auto\n            type=\"abort\"\n            onClick={() => setCreditModalVisible(true)}\n          >\n            关于\n          </Button>\n        </Grid>\n        <Grid>\n          <Button\n            icon={<Github />}\n            auto\n            type=\"abort\"\n            onClick={() => {\n              window.open(\"https://github.com/owlzou/zsv\", \"_blank\");\n            }}\n          >\n            Github\n          </Button>\n        </Grid>\n      </Grid.Container>\n    </Grid.Container>\n  );\n\n  return (\n    <GeistProvider themes={[softDarkTheme]} themeType={settings.theme}>\n      <CssBaseline />\n      <div className=\"App\">\n        <Header />\n        <Grid.Container gap={2} style={{ padding: \"0 20px\" }}>\n          <Grid sm={24} md={12}>\n            <ZCanvas\n              vertexSource={vertexSource}\n              fragmentSource={fragmentSource}\n            ></ZCanvas>\n          </Grid>\n          <Grid sm={24} md={12}>\n            <link\n              rel=\"stylesheet\"\n              href={`https://unpkg.com/codemirror@5.59.0/theme/${settings.cmTheme}.css`}\n            />\n            <Tabs initialValue=\"2\" style={{ width: \"100%\" }}>\n              <Tabs.Item label=\"顶点着色器\" value=\"1\">\n                <Cmirror\n                  value={vertexSource}\n                  theme={settings.cmTheme}\n                  onChange={(code: string) => {\n                    setVertexSource(code);\n                  }}\n                ></Cmirror>\n              </Tabs.Item>\n              <Tabs.Item label=\"片段着色器\" value=\"2\">\n                <Cmirror\n                  value={fragmentSource}\n                  theme={settings.cmTheme}\n                  onChange={(code: string) => setFragmentSource(code)}\n                ></Cmirror>\n              </Tabs.Item>\n              <Tabs.Item label=\"工具\" value=\"3\">\n                <Tools />\n              </Tabs.Item>\n              <Tabs.Item label=\"设置\" value=\"4\">\n                <Settings\n                  prop={settings}\n                  onChange={(val) => {\n                    const storage = window.localStorage;\n                    storage[\"settings\"] = JSON.stringify(val);\n                    setSettings(val);\n                  }}\n                />\n              </Tabs.Item>\n            </Tabs>\n          </Grid>\n        </Grid.Container>\n      </div>\n      <PresetModal\n        onPreset={onPreset}\n        visible={presetModalVisible}\n        onClose={() => setPresetModalVisible(false)}\n      />\n      <VaribleModal\n        visible={varibleModalVisible}\n        onClose={() => setVaribleModalVisible(false)}\n      />\n      <CreditModal\n        visible={creditModalVisible}\n        onClose={() => setCreditModalVisible(false)}\n      />\n    </GeistProvider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { GeistProvider, CssBaseline } from \"@geist-ui/core\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <GeistProvider>\n      <CssBaseline />\n      <App />\n    </GeistProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}